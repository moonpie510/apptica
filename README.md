# Модуль Application Top Category Positions

## Функционал
1. Сбор и сохранение prepared данных для endpoint-а.
2. Endpoint для получения позиций в топ чарте маркета по категориям.
3. Ограничение по количеству запросов на endpoint с одного ip-адреса: 5 запросов в минуту.
4. Логирование запросов на endpoint. Для логирования используется ELK стек.
5. Тесты

## Как развернуть
1. Запустите `docker compose up -d --build`.
2. Запустите скрипт `entrypoint.sh`. Или повторите команды из этого скрипта

После запуска `entrypoint.sh` приложение полностью готово и наполнено всеми необходимыми данными.

## Структура
### API
Установлено ограничение количества запросов в файле `AppServiceProvider`,
а так же логирование с помощью ELK стека. Для логирования используется `LogRequestMiddleware`.

Перед сапуском апи необходимо:
1. Создать тестовые записи приложения и страны. Можно запустить сиды:
```php
php artisan db:seed
```

2. Наполнить БД данными по позициям. Это можно сделать с помощью команды:
```php
php artisan apptica:upload-data
```

## Тесты
Написаны тесты.

Перед запуском тестов необходимо создать тестовую БД `apptica_test`.

Команда для создания тестовой БД:
```php
php artisan test:create-schema
```
